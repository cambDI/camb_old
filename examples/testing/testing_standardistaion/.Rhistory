setwd("~/Dropbox/projects/camb/examples/testing/testing_standardistaion")
library(camb)
StandardiseMolecules(structures.file="structures.sdf",
standardised.file="standardised.sdf",
removed.file="removed.sdf",
remove.inorganic=TRUE,
fluorine.limit=3,
chlorine.limit=3,
bromine.limit=3,
iodine.limit=3,
min.mass.limit=20,
max.mass.limit=900)
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
setwd("~/Dropbox/projects/camb/examples/testing/testing_padel_descriptor_generation")
GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
GeneratePadelDescriptors.internal <- function(structures.file, descriptors.file, types, threads = -1) {
print("Generating Descriptors")
.jinit()
.jcall("java/lang/System","S","setProperty","java.awt.headless","true")
# add all JARs
.jaddClassPath(Sys.glob("lib/*.jar"))
# call the main() method on the main class
# replace the options in the padel_config.txt file
padel_config_file <- system.file("extdata", "padel_config.txt", package="camb")
readCon  <- file(padel_config_file, open = "r")
conffile <- tempfile("padel_config", fileext=".txt")
confCon <- file(conffile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "="))
if(vec[1]=="Compute2D") {
if("2D" %in% types) {
lines <- c(lines, "Compute2D=true")
}
}
if(vec[1]=="ComputeFingerprints") {
if("Fingerprints" %in% types) {
lines <- c(lines, "ComputeFingerprints=true")
}
}
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else if(vec[1]=="DescriptorFile") {
lines <- c(lines, paste("DescriptorFile=", descriptors.file, sep=""))
}
else if(vec[1]=="Directory") {
lines <- c(lines, paste("Directory=", structures.file, sep=""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, confCon)
close(readCon)
close(confCon)
# replace the options in the padel_types.xml file
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- tempfile("padel_types", fileext=".xml")
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "="))
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
.jcall("padeldescriptor.PaDELDescriptorApp", , "main", c("-config", conffile, "-descriptortypes", descfile))
}
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library(camb)
GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
descriptors
dim(descriptors)
names(descriptors)
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
dim(descriptors)
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
dim(descriptors)
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- tempfile("padel_types", fileext=".xml")
descCon <- file(descfile)
lines <- c()
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "="))
print(line)
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else {
lines <- c(lines, line)
}
}
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else {
lines <- c(lines, line)
}
}
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else {
lines <- c(lines, line)
}
}
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- tempfile("padel_types", fileext=".xml")
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[1]=="MaxThreads") {
lines <- c(lines, paste("MaxThreads=", threads, sep=""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- tempfile("padel_types", fileext=".xml")
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, sep="\""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
setwd("~/Dropbox/projects/camb/examples/testing/testing_padel_descriptor_generation")
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- "padel_types.xml"
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, sep="\""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- "padel_types.xml"
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, sep="\""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- "padel_types.xml"
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, sep=""""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- "padel_types.xml"
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, sep="."))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
?paste
types <- c("SubstructureFingerprinter", "PubchemFingerprinter")
padel_types_file <- system.file("extdata", "padel_types.xml", package="camb")
readCon  <- file(padel_types_file, open = "r")
descfile <- "padel_types.xml"
descCon <- file(descfile)
lines <- c()
while (length(line <- readLines(readCon, n = 1, warn = FALSE)) > 0) {
vec <- unlist(strsplit(line, "\""))
print(vec)
if(vec[2] %in% types) {
vec[4] <- "true"
lines <- c(lines, paste(vec, collapse="\""))
}
else {
lines <- c(lines, line)
}
}
writeLines(lines, descCon)
close(readCon)
close(descCon)
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
dim(descriptors)
names(descriptors)
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D"))
dim(descriptors)
names(descriptors)
descriptors <- GeneratePadelDescriptors(standardised.file="../testing_standardistaion/standardised.sdf", types=c("2D", "ExtendedFingerprinter"))
dim(descriptors)
names(descriptors)
head(descriptors)
setwd("~/Dropbox/projects/camb/examples/LogS/Reference_2")
setwd("~/Dropbox/projects/camb/examples/testing/testing_standardistaion")
detach("package:camb", unload=TRUE)
library("camb", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
StandardiseMolecules(structures.file="structures.sdf",
standardised.file="standardised.sdf",
removed.file="removed.sdf",
target.file="targets.csv",
target.field.name = "EXPT",
remove.inorganic=TRUE,
fluorine.limit=3,
chlorine.limit=3,
bromine.limit=3,
iodine.limit=3,
min.mass.limit=20,
max.mass.limit=900)
