dev.off()
load("gpe0.1.rda")
error.bar <- function(x, y, upper, lower=upper, length=0.1,...){
if(length(x) != length(y) | length(y) !=length(lower) | length(lower) != length(upper))
stop("vectors must be same length")
arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
}
load("../data.rda")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/ensembles_small/gpe_backup")
load("../data.rda")
z.test <- as.vector(predict(gpe$finalModel, newdata = x.test))
load("z.test_var.rda")
axes.max <- max(c(max(z.test),max(y.test)))
axes.min <- min(c(min(z.test),min(y.test)))
y.test <- y.test[1:100]
z.test <- z.test[1:100]
z.test_var <- z.test_var[1:100]
axes.max <- max(c(max(z.test),max(y.test)))
axes.min <- min(c(min(z.test),min(y.test)))
plot(y.test,z.test, xlim=c(axes.min,axes.max), ylim=c(axes.min,axes.max), main="GP Poly NO FS.Observed (x) vs Predicted (y). Variance", xlab ="Observed", ylab="Predicted")
error.bar(y.test,z.test,z.test_var,col="red")
error.bar(y.test,z.test,z.test_var + variance[i],col="red")
plot(z.test_var,abs(y.test-z.test))
plot(abs(y.test-z.test),z.test_var)
x.test <- x.test[1:100]
train_colums <- colSums(x.train)
distances <- c()
for(i in 1:nrow(x.test)){
distances[i] <- euc.dist(x.test[i,],train_colums)
}
euc.dist <- function(x1,x2){
sqrt(sum((x1 - x2) ^ 2))
}
train_colums <- colSums(x.train)
distances <- c()
for(i in 1:nrow(x.test)){
distances[i] <- euc.dist(x.test[i,],train_colums)
}
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
setwd("/Users/daniel/Dropbox/projects/logP_workflow/tetko_molecules")
d <- read.csv("tetkosmallset.csv")
head(d)
star <- which(d$DATASET.log10 == "BioByte star")
star
dstar <- d[star,]
dnstar <- d[-star,]
smiles <- data.frame(SMILES = d$SMILES, ID=d$MOLECULEID)
smiles <- data.frame(SMILES = d$SMILES, external_id=d$MOLECULEID)
write.table(x=smiles, file=paste("tetkosmall", "_SMILES.smi", sep=""), quote=FALSE, sep=' ', row.names = FALSE, col.names = FALSE)
library(smPredict)
PredictLogP(structures.file="2D_tetkosmall_SMILES.smi", threads=1, debug=TRUE)
?trainControl
library(rJava)
library(png)
library(mclust)
library(multicore)
library(kernlab)
library(caret)
library(smPredict)
?train
biocLite("rJava")
library(smPredict)
version
library()
vignette("adegenet-basics")
vignette("adegenet-genomics")
x <- c(1,2,3,NA)
mean(x)
mean(x, na.rm=TRUE)
length(x)
is.na(x)
which(is.na(x))
length(which(!is.na(x))
)
library(matie)
x <- rnorm(n=1000, 0, 1)
y <- x
plot(x,y)
ma(x,y)
ma(data.frame(x,y))
y <- rnorm(n=1000, 0, 1)
plot(x,y)
ma(data.frame(x,y))
y <- x + rnorm(n=1000, 0, 1)
plot(x,y)
ma(data.frame(x,y))
ma(data.frame(x,y))
ma(data.frame(x,y))
x <- rnorm(n=100000, 0, 1)
y <- rnorm(n=100000, 0, 1)
ma(data.frame(x,y))
library(errorestimatoR)
setwd("~/Dropbox/projects/camb/examples/testing/testing_drawing_molecules")
df <- data.frame()
g <- ggplot(df) + geom_point() + xlim(0, 1) + ylim(0, 1)
library(ggplot2)
df <- data.frame()
g <- ggplot(df) + geom_point() + xlim(0, 1) + ylim(0, 1)
g <- ggplot(df) + geom_point() + xlim(0, 1) + ylim(0, 1)
g
g + annotation
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
img <- readPNG("temp.png")
library(png)
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
library(grid)
g <- rasterGrob(img, interpolate=TRUE)
annotation <- annotation_custom(g, xmin=0, xmax=1,
ymin=0, ymax=1)
g + annotation
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
g + annotation
g <- ggplot(df) + geom_point() + xlim(0, 1) + ylim(0, 1)
g <- ggplot(df) + annotation + xlim(0, 1) + ylim(0, 1)
g <- ggplot(df) + geompoint() + xlim(0, 1) + ylim(0, 1)
g <- ggplot(df) + geom_point() + xlim(0, 1) + ylim(0, 1)
g
g + annotation
annotation + g
g <- ggplot(df) + xlim(0, 1) + ylim(0, 1)
g + annotation
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation <- annotation_custom(g, xmin=0, xmax=1,ymin=0, ymax=1)
base <- qplot(1:10, 1:10, geom = "blank") + theme_bw()
base
base + annotation
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:10, 0:10, geom = "blank") + theme_bw()
base + annotation
df <- data.frame()
ggplot(df) + geom_blank()
geom_blank()
geom_blank()
geom_blank()
ggplot(df) + geom_blank()
ggplot(df) + geom_blank()
g <- ggplot(df) + geom_blank() + xlim(0, 1) + ylim(0, 1)
g <- ggplot(df) + geom_blank() + xlim(0, 10) + ylim(0, 10)
g
g + annotation
g <- ggplot(df) + geom_blank() + xlim(0, 10) + ylim(0, 10) + theme_bw()
g
g + annotation
base <- qplot(0:10, 0:10, geom = "blank") + theme_bw()
base + annotation
theme_bare <- theme(
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
#axis.ticks.length = unit(0, "lines"), # Error
axis.ticks.margin = unit(c(0,0,0,0), "lines"),
legend.position = "none",
panel.background = element_rect(fill = "gray"),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.margin = unit(c(0,0,0,0), "lines"),
plot.background = element_rect(fill = "blue"),
plot.margin = unit(c(0,0,0,0), "lines")
)
base <- qplot(0:10, 0:10, geom = "blank") + theme_bare
base + annotation
base <- qplot(0:10, 0:10, geom = "blank") + theme_bare()
base <- qplot(0:10, 0:10, geom = "blank") + theme_bare
base + annotation
theme_bare <- theme(
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
#axis.ticks.length = unit(0, "lines"), # Error
axis.ticks.margin = unit(c(0,0,0,0), "lines"),
legend.position = "none",
panel.background = element_rect(fill = "white"),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.margin = unit(c(0,0,0,0), "lines"),
plot.background = element_rect(fill = "white"),
plot.margin = unit(c(0,0,0,0), "lines")
)
base <- qplot(0:10, 0:10, geom = "blank") + theme_bare
base + annotation
theme_bare <- theme(
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
#axis.ticks.length = unit(0, "lines"), # Error
axis.ticks.margin = unit(c(0,0,0,0), "lines"),
legend.position = "none",
panel.background = element_rect(fill = "white"),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.margin = unit(c(0,0,0,0), "lines"),
plot.background = element_rect(fill = "white"),
plot.margin = unit(c(0,0,0,0), "lines")
)
base <- qplot(0:9, 0:9, geom = "blank") + theme_bare
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation1 <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
annotation3 <- annotation_custom(g, xmin=0, xmax=1, ymin=2, ymax=3)
base <- qplot(0:3, 0:3, geom = "blank") + theme_bare
base + annotation1 + annotation2 + annotation3
annotation1 <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
annotation3 <- annotation_custom(g, xmin=0, xmax=1, ymin=2, ymax=3)
base <- qplot(0:3, 0:3, geom = "blank") + theme_bare
base + annotation1 + annotation2 + annotation3
base <- qplot(0:3, 0:3, geom = "blank") + theme_bare
base + annotation1 + annotation2 + annotation3
base + annotation
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1 + annotation2 + annotation3
base + annotation
annotation1 <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1
base + annotation
base + annotation
base + annotation
base + annotation
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1
annotation1 <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1 + annotation2
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1 + annotation2
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation1 <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation1
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bare
base + annotation
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw()
base + annotation
base + annotation1 + annotation2
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw()
+ theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
base + annotation1 + annotation2
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
base + annotation1 + annotation2
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation1 + annotation2
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
annotation3 <- annotation_custom(g, xmin=1, xmax=2, ymin=0, ymax=1)
annotation4 <- annotation_custom(g, xmin=1, xmax=2, ymin=1, ymax=2)
base + annotation1 + annotation2 + annotation3 + annotation4
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
annotation3 <- annotation_custom(g, xmin=1, xmax=2, ymin=0, ymax=1)
annotation4 <- annotation_custom(g, xmin=1, xmax=2, ymin=1, ymax=2)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation1 + annotation2 + annotation3 + annotation4
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation2 <- annotation_custom(g, xmin=0, xmax=1, ymin=1, ymax=2)
annotation3 <- annotation_custom(g, xmin=1, xmax=2, ymin=0, ymax=1)
annotation4 <- annotation_custom(g, xmin=1, xmax=2, ymin=1, ymax=2)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation1 + annotation2 + annotation3 + annotation4
base + annotation3 + annotation4
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation3 + annotation4
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation4
base + annotation3 + annotation4
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation3 + annotation4
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation3 + annotation4
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation3 + annotation4
bese
base
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation3 + annotation4
base
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation4 + annotation3
base
base <- qplot(0:2, 0:2, geom = "blank") + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation4 + annotation3
base
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation4 + annotation3
base
annotation3 <- annotation_custom(g, xmin=1, xmax=2, ymin=0, ymax=1)
annotation4 <- annotation_custom(g, xmin=1, xmax=2, ymin=1, ymax=2)
base <- qplot(0:2, 0:2, geom = "blank") + theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotation4 + annotation3
base
plot(g)
base <- qplot(0:2, 0:2, geom = "blank")  +
annotation4 + annotation3 +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base
base <- qplot(0:2, 0:2, geom = "blank")  +
annotation4 +
annotation3 +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
qplot(1:10, 1:10, geom="blank") +
annotation_custom(g, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf) +
geom_point()
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:1, 0:1, geom = "blank")  +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base
base + annotation
library(gridExtra)
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation), nrow=2)
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation))
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation, nrow=2))
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation, nrow=2))
base <- qplot(0:1, 0:1, geom = "blank")  +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation), nrow=2)
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:1, 0:1, geom = "blank")  +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation
img <- readPNG("temp.png")
g <- rasterGrob(img, interpolate=TRUE)
annotation <- annotation_custom(g, xmin=0, xmax=1, ymin=0, ymax=1)
base <- qplot(0:1, 0:1, geom = "blank")  +
theme_bw() + theme(axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
base + annotation
library(gridExtra)
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation), nrow=2)
grid.arrange(arrangeGrob(base + annotation, base + annotation, base + annotation, base + annotation), nrow=1)
